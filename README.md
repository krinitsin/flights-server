# Take home task


Story: There are over 100,000 flights a day, with millions of people and cargo being transferred around the world. With so many people and different carrier/agency groups, it can be hard to track where a person might be. In order to determine the flight path of a person, we must sort through all of their flight records.

Goal: To create a simple microservice API that can help us understand and track how a particular person's flight path may be queried. The API should accept a request that includes a list of flights, which are defined by a source and destination airport code. These flights may not be listed in order and will need to be sorted to find the total flight paths starting and ending airports.

## Solution

###Usage
One button startup. Server will be available on `localhost:8080` To run web-server execute:
```
make up
```

Generate server after spec changes:
```
make gen-server
```

Tests:
```
make test
```

###Overview
The application follows common go application layout: [github](https://github.com/golang-standards/project-layout)  

Server API contract implemented in swagger. The spec can be found in
`/api/spec/server.yaml`  


Http server is generated by [go-swagger](https://github.com/go-swagger/go-swagger).

### API
Request JSON object example as described in swagger spec:
```
{
   "flights":[
      {
         "from":"IND",
         "to":"EWR"
      },
      {
         "from":"SFO",
         "to":"ATL"
      },
      {
         "from":"GSO",
         "to":"IND"
      },
      {
         "from":"ATL",
         "to":"GSO"
      }
   ]
}
```

###Response codes:
####200
Response JSON object as described in swagger:
```
{
    "path": {
        "from": "SFO",
        "to": "EWR"
    }
}
```

### Usage
```
Usage:
  identity [OPTIONS]

Application Options:
      --scheme=            the listeners to enable, this can be repeated and defaults to the schemes in the swagger spec
      --cleanup-timeout=   grace period for which to wait before killing idle connections (default: 10s)
      --graceful-timeout=  grace period for which to wait before shutting down the server (default: 15s)
      --max-header-size=   controls the maximum number of bytes the server will read parsing the request header's keys and values, including the request line. It does not limit the size of the
                           request body. (default: 1MiB)
      --socket-path=       the unix socket to listen on (default: /var/run/identity.sock)
      --host=              the IP to listen on (default: localhost) [$HOST]
      --port=              the port to listen on for insecure connections, defaults to a random value [$PORT]
      --listen-limit=      limit the number of outstanding requests
      --keep-alive=        sets the TCP keep-alive timeouts on accepted connections. It prunes dead TCP connections ( e.g. closing laptop mid-download) (default: 3m)
      --read-timeout=      maximum duration before timing out read of the request (default: 30s)
      --write-timeout=     maximum duration before timing out write of the response (default: 60s)
      --tls-host=          the IP to listen on for tls, when not specified it's the same as --host [$TLS_HOST]
      --tls-port=          the port to listen on for secure connections, defaults to a random value [$TLS_PORT]
      --tls-certificate=   the certificate to use for secure connections [$TLS_CERTIFICATE]
      --tls-key=           the private key to use for secure connections [$TLS_PRIVATE_KEY]
      --tls-ca=            the certificate authority file to be used with mutual tls auth [$TLS_CA_CERTIFICATE]
      --tls-listen-limit=  limit the number of outstanding requests
      --tls-keep-alive=    sets the TCP keep-alive timeouts on accepted connections. It prunes dead TCP connections ( e.g. closing laptop mid-download)
      --tls-read-timeout=  maximum duration before timing out read of the request
      --tls-write-timeout= maximum duration before timing out write of the response

db:
      --db.username=       Db connection username
      --db.password=       Db connection password
      --db.dbname=         Database name
      --db.port=           Db connection port
      --db.host=           Db connection host

Help Options:
  -h, --help               Show this help message
```